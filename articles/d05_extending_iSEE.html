<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extending iSEE • iUSEiSEE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Extending iSEE">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iUSEiSEE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workshop-sessions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workshop sessions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workshop-sessions">
<li><a class="dropdown-item" href="../articles/d00_about_this_workshop.html">00. About this workshop</a></li>
    <li><a class="dropdown-item" href="../articles/d01_preparation.html">01. Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/d02_iSEE_overview.html">02. An overview of iSEE</a></li>
    <li><a class="dropdown-item" href="../articles/d03_iSEE_quickrecipes.html">03. The iSEE cookbook</a></li>
    <li><a class="dropdown-item" href="../articles/d04_bonus_content.html">04. Bonus iSEE content</a></li>
    <li><a class="dropdown-item" href="../articles/d05_extending_iSEE.html">05. Extending iSEE</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iSEE/iUSEiSEE"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="d05_extending_iSEE_files/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="d05_extending_iSEE_files/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extending iSEE</h1>
                        <h4 data-toc-skip class="author">Federico
Marini<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="mailto:marinif@uni-mainz.de" class="email"&gt;marinif@uni-mainz.de&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>,
Kevin Rue-Albrecht<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="mailto:kevinrue67@gmail.com" class="email"&gt;kevinrue67@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>, Charlotte Soneson<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="mailto:charlottesoneson@gmail.com" class="email"&gt;charlottesoneson@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a>, Aaron Lun<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="mailto:infinite.monkeys.with.keyboards@gmail.com" class="email"&gt;infinite.monkeys.with.keyboards@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>4</sup></a>, Najla
Abassi<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="mailto:abassina@uni-mainz.de" class="email"&gt;abassina@uni-mainz.de&lt;/a&gt;&lt;/p&gt;'><sup>5</sup></a>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iSEE/iUSEiSEE/blob/main/vignettes/d05_extending_iSEE.Rmd" class="external-link"><code>vignettes/d05_extending_iSEE.Rmd</code></a></small>
      <div class="d-none name"><code>d05_extending_iSEE.Rmd</code></div>
    </div>

    
    
<p><img src="iSEE.png" align="right" alt="" width="120"></p>
<div class="section level2">
<h2 id="writing-isee-extensions">Writing iSEE extensions<a class="anchor" aria-label="anchor" href="#writing-isee-extensions"></a>
</h2>
<p>In this vignette, we illustrate how to:</p>
<ul>
<li>Extend an existing panel class into a new panel class</li>
<li>Derive a new panel class from an existing panel</li>
</ul>
</div>
<div class="section level2">
<h2 id="load-example-data">Load example data<a class="anchor" aria-label="anchor" href="#load-example-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://isee.github.io/iSEE/" class="external-link">"iSEE"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"datasets"</span>, <span class="st">"sce_pbmc3k.RDS"</span>, package <span class="op">=</span> <span class="st">"iUSEiSEE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p><em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em> panels
are implemented as S4 classes that store the state of each panel in
designated slots, and most of the functionality is implemented as S4
methods that describe various behavioural aspects of each panel
class.</p>
<p>As a result, new classes can be created simply by inheritance from
existing classes, overwriting methods to produce a different
behaviour.</p>
</div>
<div class="section level2">
<h2 id="deriving-an-s4-class">Deriving an S4 class<a class="anchor" aria-label="anchor" href="#deriving-an-s4-class"></a>
</h2>
<p>In this demo, let us create a new class called
<code>ReducedDimensionHexagonPlot</code>, that inherits from the
existing class <code><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot()</a></code> (implemented in the
<em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em>
package).</p>
<p>The objective is to produce a panel that displays the same
information as the original <code><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot()</a></code> panel,
but summarising data points into hexagonal bins.</p>
<p>One major motivation for this functionality is that arbitrarily large
data sets comprising many data points may be summarised into a modest
number of hexagonal bins, providing a boost in speed when rendering the
plot.</p>
<p>However, this is not without caveats:</p>
<ul>
<li>Summarising can take many forms (e.g., counting, averaging).</li>
<li>The ideal number of bins may be different for different data
sets.</li>
</ul>
<p>To proceed, the new class needs at least one additional slot to store
the number of hexagonal bins to create (i.e., a resolution for the
plot).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setClass.html" class="external-link">setClass</a></span><span class="op">(</span><span class="st">"ReducedDimensionHexagonPlot"</span>, contains<span class="op">=</span><span class="st">"ReducedDimensionPlot"</span>, </span>
<span>         slots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>BinResolution <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To properly initialise instances of the new class, the new slot must
be populated with a default value in the event that users do not specify
a bin resolution.</p>
<p>For this, we need to create a new method for the generic
<code><a href="https://rdrr.io/r/methods/new.html" class="external-link">initialize()</a></code> and the new class. We set the default
resolution to 20 hexagonal bins along each axis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">"initialize"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">.Object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/class-utils.html" class="external-link">.emptyDefault</a></span><span class="op">(</span><span class="va">args</span>, <span class="st">"BinResolution"</span>, <span class="fl">20</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">callNextMethod</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">.Object</span><span class="op">)</span>, <span class="va">args</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-constructor-function">Creating a constructor function<a class="anchor" aria-label="anchor" href="#creating-a-constructor-function"></a>
</h2>
<p>It is best practice to give users a function to create objects a
particular class. Traditionally, the function is named identically to
the class.</p>
<p>In this example, the function passes all its arguments to the
<code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code> function. This is standard practice in <em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em>, where
the arguments for constructor functions are typically the values of the
various slots that describe the initial state of the panel.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ReducedDimensionHexagonPlot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>At this point, we can already demonstrate that we have a functional
new panel class… that is a carbon copy of the parent class it inherits
from!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-initial.png" width="977"></p>
<p>How can we even tell which is which?!</p>
</div>
<div class="section level2">
<h2 id="changing-the-public-panel-name">Changing the public panel name<a class="anchor" aria-label="anchor" href="#changing-the-public-panel-name"></a>
</h2>
<p>The generic <code><a href="https://isee.github.io/iSEE/reference/getEncodedName.html" class="external-link">.fullName()</a></code> declares the label shown in the
interface, at the top of each panel.</p>
<p>Let us create a method for the new class, that gives it a different
name, highlighting the hexagonal binning in the plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">".fullName"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, </span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="st">"Hexagonal reduced dimension plot"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s launch the app to see the effect</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-name.png" width="977"></p>
</div>
<div class="section level2">
<h2 id="changing-the-background-panel-colour">Changing the background panel colour<a class="anchor" aria-label="anchor" href="#changing-the-background-panel-colour"></a>
</h2>
<p>Similarly, the generic <code><a href="https://isee.github.io/iSEE/reference/getPanelColor.html" class="external-link">.panelColor()</a></code> declares the
background colour of the panel header (as well as the colour of brushes
for compatible panels).</p>
<p>Let us create a method for the new class, that gives it a different
colour.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">".panelColor"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="st">"#991717"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s launch the app to see the effect</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-color.png" width="977"></p>
</div>
<div class="section level2">
<h2 id="altering-the-user-interface">Altering the user interface<a class="anchor" aria-label="anchor" href="#altering-the-user-interface"></a>
</h2>
<p>At this point, there is still no component in the user interface to
control the resolution value store in the new slot.</p>
<p>A number of S4 methods control the interface elements displayed in
the various groups of parameters located under each panel.</p>
<p>Here, we are discussing a parameter that will control the
<em>size</em> of bins. Moreover, we are about to replace data points by
hexagonal bins, meaning that the visual parameters controlling the size
of data points are about to become useless.</p>
<p>Thus, the generic <code><a href="https://isee.github.io/iSEE/reference/visual-parameters-generics.html" class="external-link">.defineVisualSizeInterface()</a></code> is the
natural choice to use for replacing the size parameters of the parent
<code>ReducedDimensionHexagonPlot()</code> class by a new HTML element
that displays a numeric input allowing users to change the hexagonal bin
resolution.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">".defineVisualSizeInterface"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/getEncodedName.html" class="external-link">.getEncodedName</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">tagList</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://isee.github.io/iSEE/reference/interface-wrappers.html" class="external-link">.numericInput.iSEE</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"BinResolution"</span>, label<span class="op">=</span><span class="st">"Bin resolution:"</span>,</span>
<span>                       min<span class="op">=</span><span class="fl">1</span>, value<span class="op">=</span><span class="va">x</span><span class="op">[[</span><span class="st">"BinResolution"</span><span class="op">]</span><span class="op">]</span>, step <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, VisualBoxOpen <span class="op">=</span> <span class="cn">TRUE</span>, VisualChoices <span class="op">=</span> <span class="st">"Size"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, VisualBoxOpen <span class="op">=</span> <span class="cn">TRUE</span>, VisualChoices <span class="op">=</span> <span class="st">"Size"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-visual.png" width="977"></p>
</div>
<div class="section level2">
<h2 id="altering-the-panel-output">Altering the panel output<a class="anchor" aria-label="anchor" href="#altering-the-panel-output"></a>
</h2>
<p>Time for the most exciting and challenging task: making the panel
produce a different type of plot!</p>
<p>To this end, the generic <code><a href="https://isee.github.io/iSEE/reference/plot-generics.html" class="external-link">.generateDotPlot()</a></code> is key.
Given a panel state, axis labels, and an environment that contains the
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment()</a></code> object and possibly other relevant
values such as incoming selections,</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">".generateDotPlot"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">labels</span>, <span class="va">envir</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot_cmds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">plot_cmds</span><span class="op">[[</span><span class="st">"ggplot"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ggplot() +"</span></span>
<span>  <span class="va">color_lab</span> <span class="op">&lt;-</span> <span class="st">"Count"</span></span>
<span>  <span class="va">new_aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/aes-utils.html" class="external-link">.buildAes</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">plot_cmds</span><span class="op">[[</span><span class="st">"hex"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>    <span class="st">"ggplot2::geom_hex(%s, bins = %i, plot.data) +"</span>,</span>
<span>    <span class="va">new_aes</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"BinResolution"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">plot_cmds</span><span class="op">[[</span><span class="st">"theme_base"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"theme_bw()"</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="fu"><a href="https://isee.github.io/iSEE/reference/manage_commands.html" class="external-link">.textEval</a></span><span class="op">(</span><span class="va">plot_cmds</span>, <span class="va">envir</span><span class="op">)</span>, commands<span class="op">=</span><span class="va">plot_cmds</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, VisualBoxOpen <span class="op">=</span> <span class="cn">TRUE</span>, VisualChoices <span class="op">=</span> <span class="st">"Size"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, VisualBoxOpen <span class="op">=</span> <span class="cn">TRUE</span>, VisualChoices <span class="op">=</span> <span class="st">"Size"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-output.png" width="977"></p>
</div>
<div class="section level2">
<h2 id="adding-reactivity">Adding reactivity<a class="anchor" aria-label="anchor" href="#adding-reactivity"></a>
</h2>
<p>At this point, if users change the bin resolution using the newly
added interface element, they will notice that nothing seems to
happen.</p>
<p>That is because we have not yet added a Shiny observer responding to
this particular event.</p>
<p>The <code><a href="https://isee.github.io/iSEE/reference/observer-generics.html" class="external-link">.createObservers()</a></code> generic is invoked to create
observers for all the instances of each panel class added to the user
interface.</p>
<p>The <code><a href="https://isee.github.io/iSEE/reference/createProtectedParameterObservers.html" class="external-link">.createProtectedParameterObservers()</a></code> function
provides a convenient way to create observers responding to events that
change the data being plotted and potentially break active multiple
selections, if any. This function automatically ensures that any change
of value in the interface element is updated in the panel state and
triggers re-rendering of the panel plot.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html" class="external-link">setMethod</a></span><span class="op">(</span><span class="st">".createObservers"</span>, <span class="st">"ReducedDimensionHexagonPlot"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">se</span>, <span class="va">input</span>, <span class="va">session</span>, <span class="va">pObjects</span>, <span class="va">rObjects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html" class="external-link">callNextMethod</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">plot_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/getEncodedName.html" class="external-link">.getEncodedName</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://isee.github.io/iSEE/reference/createProtectedParameterObservers.html" class="external-link">.createProtectedParameterObservers</a></span><span class="op">(</span><span class="va">plot_name</span>,</span>
<span>        fields<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BinResolution"</span><span class="op">)</span>,</span>
<span>        input<span class="op">=</span><span class="va">input</span>, pObjects<span class="op">=</span><span class="va">pObjects</span>, rObjects<span class="op">=</span><span class="va">rObjects</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>With the new observer in place, we can launch the app one more time,
to toy with the bin resolution and watch the panel plot being
re-rendered each time.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://isee.github.io/iSEE/reference/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ReducedDimensionHexagonPlot</span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, VisualBoxOpen <span class="op">=</span> <span class="cn">TRUE</span>, VisualChoices <span class="op">=</span> <span class="st">"Size"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://isee.github.io/iSEE/reference/ReducedDimensionPlot-class.html" class="external-link">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/05-hex-reactivity.png" width="977"></p>
</div>
<div class="section level2">
<h2 id="further-work">Further work<a class="anchor" aria-label="anchor" href="#further-work"></a>
</h2>
<p>At this point, there are many more aspects of the plotting behaviour
that we should test and adjust, making sure that all the choices of
parameters presented to end users are sensible, and that all
combinations of parameters are handled without error.</p>
<p>However, that work represents many hours of careful testing and
implementation that is far beyond the scope of this short package
demo.</p>
<p>Adventurous souls may be interested in a more mature implementation
of the <code><a href="https://rdrr.io/pkg/iSEEhex/man/ReducedDimensionHexPlot-class.html" class="external-link">ReducedDimensionHexPlot()</a></code> panel class, implemented
in the <em><a href="https://bioconductor.org/packages/3.21/iSEEhex" class="external-link">iSEEhex</a></em>
package. Source code can be found on GitHub on <a href="https://github.com/iSEE/iSEEhex/blob/main/R/ReducedDimensionHexPlot.R" class="external-link">this
page</a>.</p>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a>
</h2>
<p>The book <a href="https://isee.github.io/iSEE-book/" class="external-link">Extending
iSEE</a> is the original effort from developers to provide guidance for
writing <em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em>
extensions using example use cases for illustration.</p>
<p>The more recent <a href="https://isee.github.io/iSEETheBook/" class="external-link">iSEETheBook</a> launched a
new effort to provide a comprehensive view of the ecosystem for all
three major groups of users:</p>
<ul>
<li>End users interacting with the graphical user interface in their web
browser.</li>
<li>Developers of scripted web-applications using <em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em> to
showcase data sets.</li>
<li>Developers of extensions contributing new functionality and packages
to the <em><a href="https://bioconductor.org/packages/3.21/iSEE" class="external-link">iSEE</a></em>
ecosystem.</li>
</ul>
<p>The <a href="https://isee.github.io/" class="external-link">iSEE website</a> is the place
to watch for links to additional resources.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<details><summary><b> Session info </b>
</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] iSEE_2.20.0                 SingleCellExperiment_1.30.1</span></span>
<span><span class="co">#&gt;  [3] SummarizedExperiment_1.38.1 Biobase_2.68.0             </span></span>
<span><span class="co">#&gt;  [5] GenomicRanges_1.60.0        GenomeInfoDb_1.44.1        </span></span>
<span><span class="co">#&gt;  [7] IRanges_2.42.0              S4Vectors_0.46.0           </span></span>
<span><span class="co">#&gt;  [9] BiocGenerics_0.54.0         generics_0.1.4             </span></span>
<span><span class="co">#&gt; [11] MatrixGenerics_1.20.0       matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt; [13] BiocStyle_2.36.0           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] rlang_1.1.6             magrittr_2.0.3          shinydashboard_0.7.3   </span></span>
<span><span class="co">#&gt;  [4] clue_0.3-66             GetoptLong_1.0.5        compiler_4.5.1         </span></span>
<span><span class="co">#&gt;  [7] mgcv_1.9-3              png_0.1-8               systemfonts_1.2.3      </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5             pkgconfig_2.0.3         shape_1.4.6.1          </span></span>
<span><span class="co">#&gt; [13] crayon_1.5.3            fastmap_1.2.0           XVector_0.48.0         </span></span>
<span><span class="co">#&gt; [16] fontawesome_0.5.3       promises_1.3.3          rmarkdown_2.29         </span></span>
<span><span class="co">#&gt; [19] UCSC.utils_1.4.0        shinyAce_0.4.4          ragg_1.4.0             </span></span>
<span><span class="co">#&gt; [22] xfun_0.53               cachem_1.1.0            jsonlite_2.0.0         </span></span>
<span><span class="co">#&gt; [25] listviewer_4.0.0        later_1.4.2             DelayedArray_0.34.1    </span></span>
<span><span class="co">#&gt; [28] parallel_4.5.1          cluster_2.1.8.1         R6_2.6.1               </span></span>
<span><span class="co">#&gt; [31] bslib_0.9.0             RColorBrewer_1.1-3      jquerylib_0.1.4        </span></span>
<span><span class="co">#&gt; [34] Rcpp_1.1.0              iterators_1.0.14        knitr_1.50             </span></span>
<span><span class="co">#&gt; [37] httpuv_1.6.16           Matrix_1.7-3            splines_4.5.1          </span></span>
<span><span class="co">#&gt; [40] igraph_2.1.4            tidyselect_1.2.1        abind_1.4-8            </span></span>
<span><span class="co">#&gt; [43] yaml_2.3.10             doParallel_1.0.17       codetools_0.2-20       </span></span>
<span><span class="co">#&gt; [46] miniUI_0.1.2            lattice_0.22-7          tibble_3.3.0           </span></span>
<span><span class="co">#&gt; [49] shiny_1.11.1            evaluate_1.0.4          desc_1.4.3             </span></span>
<span><span class="co">#&gt; [52] circlize_0.4.16         pillar_1.11.0           BiocManager_1.30.26    </span></span>
<span><span class="co">#&gt; [55] DT_0.33                 foreach_1.5.2           shinyjs_2.1.0          </span></span>
<span><span class="co">#&gt; [58] ggplot2_3.5.2           scales_1.4.0            xtable_1.8-4           </span></span>
<span><span class="co">#&gt; [61] glue_1.8.0              tools_4.5.1             colourpicker_1.3.0     </span></span>
<span><span class="co">#&gt; [64] fs_1.6.6                grid_4.5.1              colorspace_2.1-1       </span></span>
<span><span class="co">#&gt; [67] nlme_3.1-168            GenomeInfoDbData_1.2.14 vipor_0.4.7            </span></span>
<span><span class="co">#&gt; [70] cli_3.6.5               textshaping_1.0.1       S4Arrays_1.8.1         </span></span>
<span><span class="co">#&gt; [73] viridisLite_0.4.2       ComplexHeatmap_2.24.1   dplyr_1.1.4            </span></span>
<span><span class="co">#&gt; [76] gtable_0.3.6            rintrojs_0.3.4          sass_0.4.10            </span></span>
<span><span class="co">#&gt; [79] digest_0.6.37           SparseArray_1.8.1       ggrepel_0.9.6          </span></span>
<span><span class="co">#&gt; [82] rjson_0.2.23            htmlwidgets_1.6.4       farver_2.1.2           </span></span>
<span><span class="co">#&gt; [85] htmltools_0.5.8.1       pkgdown_2.1.3           lifecycle_1.0.4        </span></span>
<span><span class="co">#&gt; [88] httr_1.4.7              shinyWidgets_0.9.0      GlobalOptions_0.1.2    </span></span>
<span><span class="co">#&gt; [91] mime_0.13</span></span></code></pre></div>
</details>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Federico Marini, Kevin Rue-Albrecht, Charlotte Soneson, Aaron Lun, Najla Abassi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
