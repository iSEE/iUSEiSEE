---
title: "iUSEiSEE - Bonus content"
author: Federico Marini^[marinif@uni-mainz.de]
output: 
    html_document:
      theme: cosmo
      toc: yes
      toc_float: yes
      number_sections: true
vignette: >
  %\VignetteIndexEntry{04. Bonus content}
  %\VignettePackage{iUSEiSEE}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
editor_options: 
  chunk_output_type: console
bibliography: iUSEiSEErefs.bib
---

<img src="iSEE.png" align="right" alt="" width="120" />

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  cache = FALSE,
  collapse = TRUE,
  comment = "#>",
  crop = NA
)
suppressPackageStartupMessages({
  library("BiocStyle")
  library("iSEE")
})
htmltools::tagList(rmarkdown::html_dependency_font_awesome())
```

```{r, eval=!exists("SCREENSHOT"), include=FALSE}
SCREENSHOT <- function(x, ...) knitr::include_graphics(x)
```


# Moar iSEE things

This vignette contains some examples on even more `iSEE`-things.

We will use the following packages throughout its content (make sure to have them installed if you want to run it interactively)

```{r pkgs}
library("iSEE")
library("iSEEfier")
library("iSEEu")
library("iSEEindex")
```



## iSEE a challenge: let's reproduce any figure!

TODO

## iSEEfier

TODO

Najla :)

## iSEEhub & iSEEindex


### iSEEhub: `iSEE`ing the ExperimentHub datasets

The `r Biocpkg("iSEEhub")` package provides a custom landing page for an `r Biocpkg("iSEE")` application interfacing with the Bioconductor `r Biocpkg("ExperimentHub")`. 
The landing page allows users to browse the ExperimentHub, select a data set, download and cache it, and import it directly into an iSEE app.

```{r, eval=FALSE}
library("iSEE")
library("iSEEhub")

ehub <- ExperimentHub()
app <- iSEEhub(ehub)
app
```

<!-- Possible actions: -->
<!-- select a dataset from DuoClustering -->
<!-- start iSEE on that -->

### iSEEindex: one instance of `iSEE` to explore them all

`r Biocpkg("iSEEindex")` provides an interface to **any** collection of data sets within a single iSEE web-application.  
The main functionality of this package is to define a custom landing page allowing app maintainers to list a custom collection of data sets that users can select from and directly load objects into an iSEE web application.
To see how to configure such an app, we will create a small example:

```{r, eval=FALSE}
bfc <- BiocFileCache(cache = tempdir())

dataset_fun <- function() {
    x <- yaml::read_yaml(system.file(package = "iSEEindex", "example.yaml"))
    x$datasets
}
initial_fun <- function() {
    x <- yaml::read_yaml(system.file(package = "iSEEindex", "example.yaml"))
    x$initial
}
app <- iSEEindex(bfc, dataset_fun, initial_fun)
app
```

A more elaborate example is available at [https://rehwinkellab.shinyapps.io/ifnresource/](https://rehwinkellab.shinyapps.io/ifnresource/). 
The source can be found at [https://github.com/kevinrue/IFNresource](https://github.com/kevinrue/IFNresource). 

<!-- Possible actions: -->
<!-- navigate to github repo -->
<!-- explore the app.R file -->
<!-- check the initial state files -->
<!-- have a look at the configuration yaml -->

Potential use cases can include:

* An app to present and explore the different datasets in your next publication
* An app to explore collection of datasets collaboratively, in consortium-like initiatives
* An app to mirror and enhance the content of e.g. the cellxgene data portal
* Got any ideas on how to use iSEE for such deployments?

## iSEEde and iSEEpathways

iSEEde and iSEEpathways: ideal companions for exploring DE results

```{r}
macrophage_location <- system.file("datasets", "sce_macrophage_readytouse.RDS", 
                                   package = "iUSEiSEE")
macrophage_location

sce_macrophage <- readRDS(macrophage_location)

library("iSEE")
library("iSEEde")
library("iSEEpathways")
```


`r Biocpkg("iSEEde")` and `r Biocpkg("iSEEpathways")` are two new Bioconductor packages that provide `r Biocpkg("iSEE")` panels specifically aimed towards exploration of differential expression and pathway analysis results. 
More precisely, `r Biocpkg("iSEEde")` provides the `VolcanoPlot`, `MAPlot`, `LogFCLogFCPlot` and `DETable` panels. 
These panels can be configured to extract data that was added via the `embedContrastResults()` function above. 
Let's look at an example:

```{r, eval=FALSE}
app <- iSEE(sce_macrophage, initial = list(
    DETable(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2", 
            HiddenColumns = c("baseMean", "lfcSE", "stat")),
    VolcanoPlot(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2"),
    MAPlot(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2")
))
app
```

<!-- Possible actions: -->
<!-- select some genes from any panel and pass the selection to others -->
<!-- move panels around, add some, update configuration -->
<!-- hover with the mouse to have the tooltip show up -->
<!-- usual iSEE magic: export code for the plots -->

Note how it is easy to switch to a different contrast in any of the panels. 

```{r, eval=FALSE}
app <- iSEE(sce_macrophage, initial = list(
    DETable(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2", 
            HiddenColumns = c("baseMean", "lfcSE", "stat")),
    VolcanoPlot(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2"),
    MAPlot(ContrastName = "IFNgTRUE.SL1344TRUE.DESeq2"),
    PathwaysTable(ResultName = "IFNgTRUE.SL1344TRUE.limma.fgsea", 
                  Selected = "GO:0046324"),
    ComplexHeatmapPlot(RowSelectionSource = "PathwaysTable1", 
                       CustomRows = FALSE, ColumnData = "condition_name",
                       ClusterRows = TRUE, Assay = "vst"),
    FgseaEnrichmentPlot(ResultName = "IFNgTRUE.SL1344TRUE.limma.fgsea",
                        PathwayId = "GO:0046324")
))
app
```

<!-- Possible actions: -->
<!-- select a pathway from PAT1 -->
<!-- transform vst data in heatmap, center -->
<!-- receive row selection in volcano and MA plot -->
<!-- change coloring to "row selection" -->
<!-- select alternative contrast and see all dependencies updated -->
<!-- usual iSEE magic: export code for the plots -->
<!-- usual iSEE magic: export code for the panel configuration -->

This one is from the demo of the 2023 workshop

## Tours: help and storytelling

TODO

# Session info {-}

```{r}
sessionInfo()
```

# References {-}
